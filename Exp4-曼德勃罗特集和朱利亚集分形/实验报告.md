# 复数动力学 - Mandelbrot集与Julia集实验报告

## 一、实验目的

1. 掌握复数迭代生成分形的基本原理
2. 理解逃逸时间算法(Escape Time Algorithm)的实现方法
3. 实现Mandelbrot集和Julia集的生成与可视化
4. 分析不同参数对分形图形的影响

## 二、实验过程

### 1. 核心算法实现

**逃逸时间算法实现:**
- 输入：复数参数c、最大迭代次数max_iter
- 处理：通过迭代公式z = z² + c计算逃逸时间
- 输出：每个点的逃逸时间(迭代次数)

**Mandelbrot集生成器:**
- 实现复数网格生成
- 记录每个c值的逃逸时间
- 返回2D逃逸时间数组

**Julia集生成器:**
- 实现复数网格生成
- 记录每个z0值的逃逸时间(固定c值)
- 返回2D逃逸时间数组

### 2. 分形实现

**Mandelbrot集参数:**
- 坐标范围：x ∈ [-2.0, 1.0], y ∈ [-1.5, 1.5]
- 最大迭代次数：100-200次
- 分辨率：800×800像素

**Julia集参数:**
- 坐标范围：x ∈ [-2.0, 2.0], y ∈ [-2.0, 2.0]
- 测试c值：-0.8+0.156j, -0.4+0.6j, 0.285+0.01j
- 最大迭代次数：100-200次
- 分辨率：800×800像素

### 3. 遇到的问题与解决

图像方向颠倒：
问题：初始实现中网格行列顺序导致图像上下翻转。
解决：通过转置矩阵（data.T）和设置 origin='lower' 修正坐标系。

计算效率低下：
问题：逐像素循环迭代耗时。
解决：使用 NumPy 向量化运算（掩码操作 mask = |Z| <= 2），批量更新未逃逸点，效率提升 10 倍以上。

颜色映射不自然：
问题：直接使用整数迭代次数着色导致色块断层。
解决：采用连续色图（如'magma'）并归一化逃逸时间，增强视觉过渡效果。

## 三、结果展示

### 1. Mandelbrot集
![mandelbrot](https://github.com/user-attachments/assets/e241a962-d00e-4369-ac12-fcf181ba4fce)
- 迭代次数对图像细节的影响

\(\text{max\_iter}=100\)：边界细节清晰，计算时间约 1 秒。\(\text{max\_iter}=200\)：新增更细微毛刺结构，但计算时间翻倍。

- 自相似性特征分析

中心心形（主瓣）与周围卫星圆盘，边界布满自相似的微型 Mandelbrot 集。

未逃逸点（黑色）代表迭代次数达上限，逃逸点颜色越深表示逃逸越慢。

### 2. Julia集 
![julia_1](https://github.com/user-attachments/assets/18cfb4a5-c6f9-4e2c-b636-e95493ebfde1)
![julia_2](https://github.com/user-attachments/assets/a4ec3ce4-0859-40dd-9f8a-64f123ab9879)
![julia_3](https://github.com/user-attachments/assets/c3fe5b27-cf83-4269-ba1a-6d4a3625c9fb)
- 不同c值对Julia集形态的影响

连通性：若c在 Mandelbrot 集内（如\(c=-0.8+0.156j\)），Julia 集连通（树枝状、网状等结构）；若c在 M 集外，Julia 集不连通（康托尘埃状）。

几何形态：c靠近 M 集边界时，Julia 集可能出现分形毛刺、细丝或局部复杂结构（如\(c=-0.4+0.6j\)的多分支形态）；c远离 M 集时（如\(c=2j\)），初始点快速逃逸，形态简单。

- 迭代次数与计算时间的关系

线性正相关：计算时间随最大迭代次数（\(\text{max\_iter}\)）增加而近似线性增长。

原因：每次迭代需对网格中所有未逃逸点执行复数运算（平方 + 加法），分辨率固定时，总运算量为\(\text{max\_iter} \times \text{网格点数}\)。

## 四、分析与思考

1. **分形特性分析**
   - Mandelbrot集与Julia集的数学关系

若参数 c 在 Mandelbrot 集内，对应的 Julia 集是连通的；若 c 在 Mandelbrot 集外，Julia 集不连通，呈康托尘埃状。

   - 逃逸半径的选择对结果的影响

选择逃逸半径为 2 是因为数学证明当 \(|z|>2\) 时序列必发散，简化了判断。若半径选小，可能误判部分未发散点；选大则增加不必要计算量。

1. **参数影响实验**
   - 不同max_iter值的效果对比
  
增大 max_iter 能呈现更多分形细节，但计算时间增加；值过小，细节缺失。

   - 分辨率与计算复杂度的关系

分辨率提高，网格点数增多，计算复杂度呈平方增长，内存占用和计算时间显著增加。

2. **扩展思考**
   - 如何实现平滑着色算法

计算逃逸时的 “分数迭代次数”，如基于对数插值，可使颜色过渡更自然，避免阶梯状断层。

   - 分形放大功能的实现思路

调整网格坐标范围，聚焦分形特定区域，重新计算并绘制，凸显自相似性。

   - 与L系统分形的比较

Mandelbrot 集和 Julia 集基于复迭代映射，有全局自相似性；L 系统基于规则字符串重写，适合模拟植物等局部生长结构。

3. **算法优化**
   - 向量化计算的优化效果

使用 NumPy 向量化运算，通过掩码批量更新未逃逸点，替代逐像素循环，大幅提升计算效率。

   - 并行计算的可能性

可利用 GPU 或多线程并行处理网格块，加速高分辨率或高迭代次数的计算。

**注：请在每一部分补充您的实验内容、图像、分析和关键代码。**
